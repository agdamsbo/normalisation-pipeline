{
  "hash": "8c3e9ed36579e6ac872df8c6951483fe",
  "result": {
    "markdown": "# Using the NeMo tool {#nemo}\n\n\n\n::: {.cell}\n\n:::\n\n\n\nThis section will exists as documentation on how we have worked with the <a class='glossary' title='Network Modification tool. Source'>NeMo</a> tool. Coding is very much inspired and copied from other sources. I will try to write sources and inspiration.\n\n## Package and upload\n\nFirst step is to get the normalised lesion masks processed by the <a class='glossary' title='Network Modification tool. Source'>NeMo</a> tool to get a \"dis-<a class='glossary' title='Term used to denote the collection of connections in the brain.'>connectome</a>\".\n\nThe online instance of the tool offers to freely process lesion masks in batches of 10. You can use the bundled *R*-script to package lesion masks into compressed zip-batches of maximum 10.\n\n1.  Open the `nemo_packing.R` file and edit the variables in the first section, then run the script, from either RStudio or the command terminal window:\n\n\n\n    ::: {.cell}\n    \n    ```{.bash .cell-code}\n    Rscript nemo-packing.R\n    ```\n    :::\n\n\n\n1.  Then head over to the [NeMo processing website](https://kuceyeski-wcm-web.s3.us-east-1.amazonaws.com/upload.html) and upload the zip-files, one at a time with your desired settings and atlas for parcellation.\n\n## ZIP to data set\n\nSo, here I'll show how we went from compressed zip file, from the NeMo tool, and to having a data set for further analyses.\n\nI am fairly new to Python, but have worked in R for many years. This means, that I have written just enough in Python, and everything else in R. Small python functions will be wrapped in R scripts. Just a word of warning.\n\nFirst, extract the compressed file and put it where you like. I'll denote this location as the `source.folder`.\n\n\n::: {.cell}\n\n:::\n\n\nThen we want to extract the `chacovol` data. This is extracted by unpikling `.pkl` files using a short python script wrapped in R:\n\n\n::: {.cell}\n\n:::\n\n\nThe unpikled files are then collected and merged in a wide format.\n\nBut first, we need to handle the provided atlas `.txt` files to get ROI names:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nThis got unneccessarily complicated due to the fixed with format of the provided atlas file. Sure you can do better!  chr [1:17] \"  1    17Networks_1_VisualA          120  18 134   0\" ...\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nThis got unneccessarily complicated due to the fixed with format of the provided atlas file. Sure you can do better!  chr [1:17] \"VisualA\" \"VisualB\" \"SomatomotorA\" \"SomatomotorB\" ...\n```\n:::\n:::\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: stRoke\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t2 obs. of  18 variables:\n $ id              : chr  \"W49\" \"W50\"\n $ VisualA         : num  7.31e-05 4.67e-04\n $ VisualB         : num  0.000053 0.000699\n $ SomatomotorA    : num  0.000802 0.100064\n $ SomatomotorB    : num  0.0016 0.0115\n $ DorsalAttentionA: num  0.000148 0.005163\n $ DorsalAttentionB: num  0.000514 0.123168\n $ SalienceVenAttnA: num  0.0093 0.1233\n $ SalienceVenAttnB: num  0.00789 0.07078\n $ LimbicB         : num  0.000746 0.000904\n $ LimbicA         : num  0.00173 0.0012\n $ ControlC        : num  0.000193 0.034858\n $ ControlA        : num  0.001 0.0788\n $ ControlB        : num  0.00248 0.07403\n $ TemporalParietal: num  0.00108 0.02597\n $ DefaultC        : num  0.000134 0.007691\n $ DefaultA        : num  0.00116 0.04838\n $ DefaultB        : num  0.00318 0.06853\n```\n:::\n:::\n\n\nI very much prefer writing function to do the data handling, but I just have to note, that these functions are very primitive due to lack of time on my end. But they are working and will provide a good foundation for further worker.\n\n### Visualisation\n\nWe also want those nice glass brains. This is entirely based on the scripts from the NeMo tool, which uses the `nibabel` Python package.\n\n\n::: {.cell}\n\n:::\n\n\n![Averaged chacovol glassbrain plot](images/glass_chacovol.png){fig-align=\"center\"}\n\n\n\n## Glossary\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}{l|l}\n\\hline\nterm & definition\\\\\n\\hline\nconnectome & Term used to denote the collection of connections in the brain.\\\\\n\\hline\nNeMo & Network Modification tool. [Source](https://github.com/kjamison/nemo)\\\\\n\\hline\n\\end{tabular}\n\\end{table}\n:::\n:::",
    "supporting": [
      "04-finding-nemo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}